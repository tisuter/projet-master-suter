<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8">
    <title>Projet Master | Activité Comprehension Orale</title>
    <script src="js/jspsych.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="plugins/jspsych-instructions.js"></script>
    <script src="plugins/jspsych-survey-text.js"></script>
    <script src="plugins/jspsych-audio-button-response.js"></script>
    <script src="plugins/jspsych-html-button-response.js"></script>
    <script src="common.js"></script>
    <link rel="stylesheet" href="css/jspsych.css">
    <link rel="stylesheet" href="css/jspsych-custom-styles.css">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body></body>

<script>
    // LEA start
    var einleitungfragen = {
        type: 'instructions',
        pages: ['<div class="left"><p>Verbinde deinen Kopfhörer. Höre den Text L’ANNIVERSAIRE und beantworte die Fragen. Bereit? Klicke auf On y va.</p></div>'],
        show_clickable_nav: true,
        allow_backward: false,
        button_label_next: 'On y va',
    };

    let choice1 = ['samedi', 'vendredi', 'jeudi'];
    let choice2 = ['à 9h', 'à 19h', 'à 21h'];
    let choice3 = ['au théâtre', 'au cinéma', 'au restaurant'];
    let choice4 = ['un gâteau au chocolat', 'un gâteau aux noisettes', 'un gâteau au citron'];
    let choice5 = ['du thé froid', 'de l’orangina', 'du coca'];
    let choice6 = ['Sandra', 'Josiane', 'Olivier'];

    var quest1 = [
        {question: '1.	Hélène fête son anniversaire quel jour ?', choice: shuffle([...choice1]), solution: 'samedi'},
        {question: '2.	À quelle heure elle invite ses amis ?', choice: shuffle([...choice2]), solution: 'à 9h'},
        {question: '3.	Où vont les parents de Hélène ?', choice: shuffle([...choice3]), solution: 'au théâtre'},
        {question: '4.	Quel gâteau apporte Josiane ?', choice: shuffle([...choice4]), solution: 'un gâteau au chocolat'},
        {question: '5.	Quelle boisson Olivier n’apporte PAS pour la fête ?', choice: shuffle([...choice5]), solution: 'du thé froid'},
        {question: '6.	Qui va s’occuper de la musique ?', choice: shuffle([...choice6]), solution: 'Sandra'},
    ];

    const quest1Text = quest1.map(item => {
        return "<p>" + item.question + "</p>"
    });

    var einleitungQuest1 = {
        type: 'instructions',
        pages: ['<h1>Lis les questions.</h1><div class="left">' + quest1Text.join("") + '</div>'],
        show_clickable_nav: true,
        allow_backward: false,
        button_label_next: 'On y va',
    };

    var audioInstructions1 = {
        timeline: [{
            type: 'audio-button-response',
            stimulus: 'sound/comprehension-orale/anniversaire.m4a',
            prompt: '<h1>Écoute.</h1>' +
                    'Merke dir die Antworten! Klicke erst auf "prochain", wenn du den Text gehört hast. Die Antworten musst du zu einem späteren Zeitpunkt eingeben.' +
                '<div class="left">' + quest1Text.join("") + '</div>',
            choices: ['répéter', 'prochain'],
            // response_allowed_while_playing: false,
        }],
        loop_function: loopFunction,
    };

    var oralFragen1 = {
        timeline: [{
            type: 'html-button-response',
            stimulus: function () {
                return "<h2>" + jsPsych.timelineVariable('question', true) + "</h2>";
            },
            choices: function () {
                return jsPsych.timelineVariable('choice', true)
            },
            prompt: "",
            on_finish: function(data){
                let solutionSelected = jsPsych.timelineVariable('choice', true)[data.button_pressed];
                let correct = jsPsych.timelineVariable('solution', true) === solutionSelected;
                data.question = jsPsych.timelineVariable('question', true);
                data.solutionSelected = jsPsych.timelineVariable('solutionSelected', true);
                data.correct = correct
            },
        }],
        timeline_variables: quest1,
    };
    // LEA ENDE
    jsPsych.init({
        //LEA START
        timeline: [einleitung, nameklasse, einleitungfragen, einleitungQuest1, audioInstructions1, oralFragen1],
        //LEA ENDE
        on_finish: function () {
            sendData("Act_comprehension-orale", jsPsych.data.get().json(true));
            jsPsych.data.displayData();
            $("#jspsych-data-display").empty();
            $("#jspsych-data-display").prepend('<h2>Merci beaucoup! Du hast die Übungen erfolgreich abgeschlossen. <a href="index.html">Hier gehts zurück.</a></h2>');
        }
    });


</script>
</html>
